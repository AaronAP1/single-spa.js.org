(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{220:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return r})),a.d(t,"rightToc",(function(){return s})),a.d(t,"default",(function(){return c}));var o=a(1),i=a(9),n=(a(0),a(288)),r={id:"recommended-setup",title:"The Recommended Setup",sidebar_label:"Overview"},s=[{value:"Overview",id:"overview",children:[]},{value:"Alternatives",id:"alternatives",children:[]},{value:"In-browser versus build-time modules",id:"in-browser-versus-build-time-modules",children:[]},{value:"Import Maps",id:"import-maps",children:[]},{value:"SystemJS",id:"systemjs",children:[]},{value:"Lazy loading",id:"lazy-loading",children:[]},{value:"Local development",id:"local-development",children:[]},{value:"Build tools (Webpack / Rollup)",id:"build-tools-webpack--rollup",children:[]},{value:"Utility modules (styleguide, API, etc)",id:"utility-modules-styleguide-api-etc",children:[]},{value:"Shared dependencies",id:"shared-dependencies",children:[]},{value:"Deployment",id:"deployment",children:[]},{value:"Continuous Integration (CI)",id:"continuous-integration-ci",children:[]},{value:"Applications versus parcels",id:"applications-versus-parcels",children:[]},{value:"Inter-app communication",id:"inter-app-communication",children:[]},{value:"State management",id:"state-management",children:[]}],l={rightToc:s},p="wrapper";function c(e){var t=e.components,a=Object(i.a)(e,["components"]);return Object(n.b)(p,Object(o.a)({},l,a,{components:t,mdxType:"MDXLayout"}),Object(n.b)("p",null,'The single-spa npm package is not opinionated about your build tools, CI process, or local development workflow. However, to implement single-spa you will have to figure all of those things out (and more). To help you decide how to approach these problems, the single-spa core team has put together a "recommended setup" that gives an opinionated approach to solving the practical problems of microfrontends.'),Object(n.b)("h2",{id:"overview"},"Overview"),Object(n.b)("p",null,"We recommend a setup that uses in-browser ES modules + import maps (or SystemJS to polyfill these if you need better browser support). This setup has several advantages:"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},"Common libraries are easy to manage, and are only downloaded once. If you're using SystemJS, you can also preload them for a speed boost as well."),Object(n.b)("li",{parentName:"ol"},"Sharing code / functions / variables is as easy as import/export, just like in a monolithic setup"),Object(n.b)("li",{parentName:"ol"},"Lazy loading applications is easy, which enables you to speed up initial load times"),Object(n.b)("li",{parentName:"ol"},"Each application (AKA microservice, AKA ES module) can be independently developed and deployed. Teams are enabled to work at their own speed, experiment (within reason as defined by the organization), QA, and deploy on thier own schedules. This usually also means that release cycles can be decreased to days instead of weeks or months"),Object(n.b)("li",{parentName:"ol"},"A great developer experience (DX): go to your dev environment and add an import map that points the application's url to your localhost. See sections below for details")),Object(n.b)("h2",{id:"alternatives"},"Alternatives"),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/umijs/qiankun"}),"qiankun")," is a popular alternative to this recommended setup."),Object(n.b)("h2",{id:"in-browser-versus-build-time-modules"},"In-browser versus build-time modules"),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=Jxqiu6pdMSU&list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&index=2"}),"Tutorial video")),Object(n.b)("p",null,"An in-browser javascript module is when imports and exports are not compiled away by your build tool, but instead are\nresolved within the browser. This is different from build-time modules, which are supplied by your node_modules and\ncompiled away before they touch the browser."),Object(n.b)("p",null,"The way to tell webpack and rollup to leave some dependencies untouched during the build, so that they come from the browser,\nis via ",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://webpack.js.org/configuration/externals/#root"}),"webpack externals")," and ",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://rollupjs.org/guide/en/#external"}),"rollup externals"),"."),Object(n.b)("p",null,"Here are our recommendations:"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},"Each single-spa application should be an in-browser Javascript module."),Object(n.b)("li",{parentName:"ol"},"Large shared dependencies (ie, the react, vue, or angular libraries) should each be in-browser modules."),Object(n.b)("li",{parentName:"ol"},"Everything else should be a build-time module.")),Object(n.b)("h2",{id:"import-maps"},"Import Maps"),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=Lfm2Ge_RUxs&list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&index=3"}),"Tutorial video")),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/WICG/import-maps"}),"Import Maps"),' are a browser specification for aliasing "import specifiers" to a URL.\nAn import specifier is the string indicating which module to load. Examples:'),Object(n.b)("pre",null,Object(n.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),"// ./thing.js is the import specifier\nimport thing from './thing.js';\n\n// react is the import specifier\nimport React from 'react';\n")),Object(n.b)("p",null,'Specifiers that are not a URL are called "bare specifiers," such as ',Object(n.b)("inlineCode",{parentName:"p"},"import 'react'"),". Being able to alias bare specifiers to a URL\nis crucial to being able to use in-browser modules, which is why import maps exist."),Object(n.b)("p",null,"As of Feb 2020, import maps are only implemented in Chrome, and behind a developer feature toggle. As such, you will need a polyfill\nto make import maps work."),Object(n.b)("h2",{id:"systemjs"},"SystemJS"),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=AmdKF2UhFzw&list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&index=7"}),"Tutorial video")),Object(n.b)("p",null,"SystemJS provides polyfill-like behavior for import maps and in-browser modules. It is not a true polyfill of import maps, due to limitations of the javascript language in polyfilling the resolution of bare import specifiers to URLs."),Object(n.b)("p",null,"Since SystemJS is only polyfill-like, you'll need to compile your applications into ",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/systemjs/systemjs/blob/master/docs/system-register.md"}),"System.register format")," instead of to ESM format. This allows for in-browser modules to be fully emulated in environments that don't support modules or import maps."),Object(n.b)("p",null,"To compile your code to System.register format, set webpack's ",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://webpack.js.org/configuration/output/#outputlibrarytarget"}),Object(n.b)("inlineCode",{parentName:"a"},"output.libraryTarget"))," to ",Object(n.b)("inlineCode",{parentName:"p"},'"system"'),", or set rollup's ",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://rollupjs.org/guide/en/#outputformat"}),Object(n.b)("inlineCode",{parentName:"a"},"format"))," to ",Object(n.b)("inlineCode",{parentName:"p"},'"system"'),"."),Object(n.b)("p",null,"Shared dependencies like React, Vue, and Angular, do not publish System.register versions of their libraries. However, you can find System.register versions of the libraries in ",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/esm-bundle"}),"the esm-bundle project")," (",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://medium.com/@joeldenning/an-esm-bundle-for-any-npm-package-5f850db0e04d"}),"blog post"),"). Alternatively, SystemJS is capable of loading them via ",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/systemjs/systemjs#2-systemjs-loader"}),"global loading")," or ",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/systemjs/systemjs#extras"}),"the AMD and named-exports extras"),"."),Object(n.b)("p",null,"An alternative to SystemJS that provides polyfill behavior for import maps is ",Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/guybedford/es-module-shims"}),"es-module-shims"),". This has the advantage of using truly native ES modules. However, it is not the single-spa core team's recommended approach for production applications, since it requires less-performant in browser parsing and modification of all your bundles."),Object(n.b)("h2",{id:"lazy-loading"},"Lazy loading"),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=-LkvBMpCK-A&list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&index=8"}),"Tutorial video")),Object(n.b)("h2",{id:"local-development"},"Local development"),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=vjjcuIxqIzY&list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&index=4"}),"Tutorial video")),Object(n.b)("h2",{id:"build-tools-webpack--rollup"},"Build tools (Webpack / Rollup)"),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=I6COIg-2lyM&list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&index=9"}),"Tutorial video")),Object(n.b)("h2",{id:"utility-modules-styleguide-api-etc"},"Utility modules (styleguide, API, etc)"),Object(n.b)("h2",{id:"shared-dependencies"},"Shared dependencies"),Object(n.b)("h2",{id:"deployment"},"Deployment"),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=QHunH3MFPZs&list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&index=5"}),"Tutorial video")),Object(n.b)("h2",{id:"continuous-integration-ci"},"Continuous Integration (CI)"),Object(n.b)("p",null,Object(n.b)("a",Object(o.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=nC7rpDXa4B8&list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&index=6"}),"Tutorial video")),Object(n.b)("h2",{id:"applications-versus-parcels"},"Applications versus parcels"),Object(n.b)("h2",{id:"inter-app-communication"},"Inter-app communication"),Object(n.b)("h2",{id:"state-management"},"State management"))}c.isMDXComponent=!0},288:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return b}));var o=a(0),i=a.n(o),n=i.a.createContext({}),r=function(e){var t=i.a.useContext(n),a=t;return e&&(a="function"==typeof e?e(t):Object.assign({},t,e)),a},s=function(e){var t=r(e.components);return i.a.createElement(n.Provider,{value:t},e.children)};var l="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},c=Object(o.forwardRef)((function(e,t){var a=e.components,o=e.mdxType,n=e.originalType,s=e.parentName,l=function(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&-1===t.indexOf(o)&&(a[o]=e[o]);return a}(e,["components","mdxType","originalType","parentName"]),c=r(a),b=o,d=c[s+"."+b]||c[b]||p[b]||n;return a?i.a.createElement(d,Object.assign({},{ref:t},l,{components:a})):i.a.createElement(d,Object.assign({},{ref:t},l))}));function b(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var n=a.length,r=new Array(n);r[0]=c;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[l]="string"==typeof e?e:o,r[1]=s;for(var b=2;b<n;b++)r[b]=a[b];return i.a.createElement.apply(null,r)}return i.a.createElement.apply(null,a)}c.displayName="MDXCreateElement"}}]);